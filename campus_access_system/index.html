<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SmartCampus Access | AI-Powered Security</title>

  <!-- Icons & Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>

  <!-- Theme -->
  <link rel="stylesheet" href="styles.css"/>

  <!-- ML libs -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.21.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
</head>
<body>
  <!-- Animated Background -->
  <div class="background-animation">
    <div class="floating-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
      <div class="shape shape-4"></div>
    </div>
  </div>

  <!-- Header -->
  <header class="glass-header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <div class="logo-icon">ðŸŽ¯</div>
          <h1>SmartCampus <span>Access</span></h1>
        </div>
        <div class="header-badge">
          <span class="live-indicator"></span>
          AI ACTIVE
        </div>
      </div>
    </div>
  </header>

  <!-- ====== VIEW: HOME ====== -->
  <main id="view-home" class="view active">
    <div class="container">
      <!-- Hero Section -->
      <section class="hero-section">
        <div class="hero-content">
          <div class="hero-text">
            <h2 class="hero-title">
              <span class="gradient-text">Intelligent Campus</span><br/>Access Control System
            </h2>
            <p class="hero-description">
              Two-step verification: Face scan and ID scan with real-time ML predictions and lock-on stability.
            </p>
            <div class="hero-stats">
              <div class="stat"><div class="stat-number">98%</div><div class="stat-label">Lock Threshold</div></div>
              <div class="stat"><div class="stat-number">1s</div><div class="stat-label">Stable Window</div></div>
              <div class="stat"><div class="stat-number">24/7</div><div class="stat-label">Monitoring</div></div>
            </div>
          </div>
          <div class="hero-visual">
            <div class="floating-card main-card">
              <div class="card-header"><h3>Live Access Control</h3><div class="status-dot live"></div></div>
              <div class="camera-preview">
                <div class="camera-feed" id="camera-feed">
                  <div class="scanning-animation"></div>
                  <div class="detection-overlay"></div>
                  <div class="phase-indicator" id="phase-indicator">
                    <span class="phase-badge">Welcome</span>
                    <span class="phase-text">Choose a mode below</span>
                  </div>
                  <div class="status-overlay" id="status-overlay">Use Interactive Demo or Solo Scanner</div>
                  <div class="detection-box" id="detection-box">ðŸ‘‹</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Control Panel -->
      <section class="control-section">
        <div class="grid-layout">
          <!-- System Status -->
          <div class="glass-card status-card">
            <h3 class="card-title"><i class="fas fa-chart-bar"></i> System Status</h3>
            <div class="status-grid">
              <div class="status-item">
                <div class="status-icon"><i class="fas fa-satellite-dish"></i></div>
                <div class="status-info">
                  <span class="status-label">Current View</span>
                  <span class="status-value" id="current-phase">Home</span>
                </div>
              </div>
              <div class="status-item">
                <div class="status-icon"><i class="fas fa-user"></i></div>
                <div class="status-info">
                  <span class="status-label">Face Status</span>
                  <span class="status-value" id="selfie-status">â€”</span>
                </div>
              </div>
              <div class="status-item">
                <div class="status-icon"><i class="fas fa-id-card"></i></div>
                <div class="status-info">
                  <span class="status-label">ID Status</span>
                  <span class="status-value" id="id-status">â€”</span>
                </div>
              </div>
              <div class="status-item">
                <div class="status-icon"><i class="fas fa-shield-alt"></i></div>
                <div class="status-info">
                  <span class="status-label">Next Step</span>
                  <span class="status-value access-status" id="access-status">Pick a mode</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Mode Tiles -->
          <div class="glass-card controls-card">
            <h3 class="card-title"><i class="fas fa-gamepad"></i> Choose Mode</h3>
            <div class="controls-grid">
              <button class="control-btn primary" id="btn-demo">
                <i class="fas fa-play"></i> Interactive Demo
              </button>
              <button class="control-btn secondary" id="btn-face-only">
                <i class="fas fa-user"></i> Face Scanner
              </button>
              <button class="control-btn secondary" id="btn-id-only">
                <i class="fas fa-id-card"></i> ID Scanner
              </button>
            </div>
          </div>

          <!-- Progress (generic info on home) -->
          <div class="glass-card progress-card">
            <h3 class="card-title"><i class="fas fa-tasks"></i> Access Progress</h3>
            <div class="progress-tracker">
              <div class="progress-step active" id="home-step-1">
                <div class="step-number">1</div>
                <div class="step-content">
                  <h4>Face Capture</h4>
                  <p>Live predictions with confidence</p>
                  <div class="step-status"><i class="fas fa-clock"></i> Pending</div>
                </div>
              </div>
              <div class="progress-step" id="home-step-2">
                <div class="step-number">2</div>
                <div class="step-content">
                  <h4>ID Capture</h4>
                  <p>Lock at â‰¥ 98% for 1s</p>
                  <div class="step-status"><i class="fas fa-clock"></i> Pending</div>
                </div>
              </div>
              <div class="progress-step" id="home-step-3">
                <div class="step-number">3</div>
                <div class="step-content">
                  <h4>Verification</h4>
                  <p>Name match check</p>
                  <div class="step-status"><i class="fas fa-clock"></i> Pending</div>
                </div>
              </div>
            </div>
          </div>

          <!-- System Logs -->
          <div class="glass-card logs-card">
            <h3 class="card-title"><i class="fas fa-terminal"></i> System Logs</h3>
            <div class="logs-container" id="logs-container">
              <div class="log-entry">
                <span class="timestamp" id="current-time">--:--:--</span>
                <span class="message">System initialized and ready</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Features Section -->
      <section class="features-section">
        <h2 class="section-title">How It Works</h2>
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-camera"></i></div>
            <h3>Face Scanner</h3>
            <p>Loads Teachable Machine model from <code>/tm_model/</code></p>
          </div>
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-id-card"></i></div>
            <h3>ID Scanner</h3>
            <p>Loads Teachable Machine model from <code>/id/id_model/</code></p>
          </div>
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-link"></i></div>
            <h3>Verification</h3>
            <p>Locks when â‰¥98% for 1s. Names must match.</p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- ====== VIEW: DEMO (two scanners + steps) ====== -->
  <section id="view-demo" class="view">
    <div class="container">
      <div class="glass-card" style="margin-top:2rem;">
        <h3 class="card-title"><i class="fas fa-tasks"></i> Capture Progress</h3>

        <div class="steps" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:1.5rem;">
          <!-- Step 1: Face -->
          <div class="floating-card">
            <div class="card-header">
              <h3>Step 1: Face</h3>
              <span class="badge" id="badge-face" data-state="pending">Pending</span>
            </div>
            <div class="camera-preview" style="height:auto;">
              <div style="position:relative;">
                <canvas id="demo-face-canvas" width="480" height="360" style="width:100%;border-radius:12px;"></canvas>
                <div class="overlay top-left" id="demo-face-topleft">â€”</div>
                <div class="overlay bottom-left" id="demo-face-bottomleft"><ul class="pred-list"></ul></div>
              </div>
            </div>
            <div style="display:flex;gap:.5rem;margin-top:1rem;">
              <button class="control-btn secondary" id="demo-face-scan-again" style="display:none;"><i class="fas fa-redo"></i> Scan Again</button>
            </div>
          </div>

          <!-- Step 2: ID -->
          <div class="floating-card">
            <div class="card-header">
              <h3>Step 2: ID</h3>
              <span class="badge" id="badge-id" data-state="pending">Pending</span>
            </div>
            <div class="camera-preview" style="height:auto;">
              <div style="position:relative;">
                <canvas id="demo-id-canvas" width="480" height="360" style="width:100%;border-radius:12px;"></canvas>
                <div class="overlay top-left" id="demo-id-topleft">â€”</div>
                <div class="overlay bottom-left" id="demo-id-bottomleft"><ul class="pred-list"></ul></div>
              </div>
            </div>
            <div style="display:flex;gap:.5rem;margin-top:1rem;">
              <button class="control-btn secondary" id="demo-id-scan-again" style="display:none;"><i class="fas fa-redo"></i> Scan Again</button>
            </div>
          </div>

          <!-- Step 3: Verify -->
          <div class="floating-card">
            <div class="card-header">
              <h3>Step 3: Verification</h3>
              <span class="badge" id="badge-verify" data-state="pending">Pending</span>
            </div>
            <div style="padding:1rem;">
              <p id="verify-status">Waiting for both locksâ€¦</p>
              <div style="display:flex;gap:.5rem;margin-top:1rem;">
                <button class="control-btn primary" id="btn-check-verify"><i class="fas fa-check"></i> Check</button>
                <button class="control-btn secondary" id="btn-demo-back"><i class="fas fa-arrow-left"></i> Back</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- ====== VIEW: SOLO FACE ====== -->
  <section id="view-solo-face" class="view">
    <div class="container">
      <div class="glass-card" style="margin-top:2rem;">
        <div class="card-header">
          <h3><i class="fas fa-user"></i> Face Scanner</h3>
        </div>
        <div style="position:relative;">
          <canvas id="solo-face-canvas" width="640" height="480" style="width:100%;border-radius:12px;"></canvas>
          <div class="overlay top-left" id="solo-face-topleft">â€”</div>
          <div class="overlay bottom-left" id="solo-face-bottomleft"><ul class="pred-list"></ul></div>
        </div>
        <div style="display:flex;gap:.5rem;margin-top:1rem;">
          <button class="control-btn secondary" id="solo-face-scan-again" style="display:none;"><i class="fas fa-redo"></i> Scan Again</button>
          <button class="control-btn secondary" id="solo-face-back"><i class="fas fa-arrow-left"></i> Back</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ====== VIEW: SOLO ID ====== -->
  <section id="view-solo-id" class="view">
    <div class="container">
      <div class="glass-card" style="margin-top:2rem;">
        <div class="card-header">
          <h3><i class="fas fa-id-card"></i> ID Scanner</h3>
        </div>
        <div style="position:relative;">
          <canvas id="solo-id-canvas" width="640" height="480" style="width:100%;border-radius:12px;"></canvas>
          <div class="overlay top-left" id="solo-id-topleft">â€”</div>
          <div class="overlay bottom-left" id="solo-id-bottomleft"><ul class="pred-list"></ul></div>
        </div>
        <div style="display:flex;gap:.5rem;margin-top:1rem;">
          <button class="control-btn secondary" id="solo-id-scan-again" style="display:none;"><i class="fas fa-redo"></i> Scan Again</button>
          <button class="control-btn secondary" id="solo-id-back"><i class="fas fa-arrow-left"></i> Back</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ====== VIEW: VERIFIED ====== -->
  <section id="view-verified" class="view">
    <div class="container">
      <div class="glass-card" style="margin-top:3rem;text-align:center;">
        <div class="success-animation"><i class="fas fa-check-circle"></i></div>
        <h2 id="verified-title">Verified</h2>
        <p id="verified-text">The person and ID belong to <strong>â€”</strong></p>
        <button class="modal-btn" id="btn-verified-done">Done</button>
      </div>
    </div>
  </section>

  <!-- (Optional modal retained) -->
  <div class="modal" id="success-modal">
    <div class="modal-content">
      <div class="success-animation"><i class="fas fa-check-circle"></i></div>
      <h2>Action Complete</h2>
      <p>Return to Home</p>
      <button class="modal-btn" onclick="closeModal()">Continue</button>
    </div>
  </div>

  <!-- App script -->
  <script src="script.js"></script>
</body>
</html>
